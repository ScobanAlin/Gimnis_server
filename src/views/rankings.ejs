<!DOCTYPE html>
<html>

<head>
  <title>Competition Rankings</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800;900&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #FFE066 0%, #FF6B35 30%, #F7931E 70%, #FFD700 100%);
      color: white;
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
    }

    /* Animated background */
    body::before {
      content: "";
      position: fixed;
      width: 200%;
      height: 200%;
      background: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M50 15L61 38h23l-18 14 7 23-23-17-23 17 7-23-18-14h23z' fill='%23ffffff' fill-opacity='0.03'/%3E%3C/svg%3E") repeat;
      animation: stars-move 30s linear infinite;
      z-index: -2;
    }

    @keyframes stars-move {
      0% {
        transform: translate(0, 0) rotate(0deg);
      }

      100% {
        transform: translate(-100px, -100px) rotate(360deg);
      }
    }

    /* Header */
    .header {
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
      padding: 30px 0;
      text-align: center;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      border-bottom: 4px solid #FFD700;
      position: relative;
      overflow: hidden;
    }

    .header::before {
      content: "";
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255, 215, 0, 0.1) 0%, transparent 70%);
      animation: header-glow 4s ease-in-out infinite;
      z-index: 0;
    }

    @keyframes header-glow {

      0%,
      100% {
        transform: scale(1);
        opacity: 0.5;
      }

      50% {
        transform: scale(1.1);
        opacity: 1;
      }
    }

    .header-content {
      position: relative;
      z-index: 1;
    }

    .header h1 {
      font-size: 48px;
      font-weight: 900;
      margin-bottom: 10px;
      background: linear-gradient(45deg, #FFD700, #FFA500, #FFD700);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      background-size: 200% 200%;
      animation: gradient-shift 3s ease-in-out infinite;
      text-transform: uppercase;
      letter-spacing: 3px;
      text-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
    }

    @keyframes gradient-shift {

      0%,
      100% {
        background-position: 0% 50%;
      }

      50% {
        background-position: 100% 50%;
      }
    }

    .header-subtitle {
      font-size: 20px;
      color: #FFD700;
      font-weight: 600;
      opacity: 0.9;
      letter-spacing: 1px;
    }

    /* Main container */
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 40px 20px;
      position: relative;
      z-index: 1;
    }

    /* Controls section */
    .controls {
      background: rgba(26, 26, 46, 0.9);
      backdrop-filter: blur(15px);
      border-radius: 20px;
      padding: 25px 30px;
      margin-bottom: 30px;
      border: 2px solid rgba(255, 215, 0, 0.3);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
    }

    .controls label {
      font-weight: 700;
      font-size: 18px;
      color: #FFD700;
      margin-right: 15px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    #category-select {
      background: linear-gradient(135deg, #FFD700, #FFA500);
      color: #003366;
      padding: 12px 20px;
      border: none;
      border-radius: 25px;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      outline: none;
      transition: all 0.3s ease;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    #category-select:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
      background: linear-gradient(135deg, #FFA500, #FFD700);
    }

    #category-select:focus {
      box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.4);
    }

    /* Category blocks */
    .category-block {
      background: rgba(26, 26, 46, 0.95);
      backdrop-filter: blur(15px);
      border-radius: 25px;
      margin-bottom: 40px;
      padding: 30px;
      border: 2px solid rgba(255, 215, 0, 0.2);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .category-block:hover {
      transform: translateY(-5px);
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4);
      border-color: rgba(255, 215, 0, 0.5);
    }

    .category-block::before {
      content: "";
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.1), transparent);
      transition: left 0.5s ease;
    }

    .category-block:hover::before {
      left: 100%;
    }

    .category-block h2 {
      font-size: 32px;
      font-weight: 800;
      margin-bottom: 25px;
      text-align: center;
      color: #FFD700;
      text-transform: uppercase;
      letter-spacing: 2px;
      text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.5);
      position: relative;
      z-index: 1;
    }

    .category-block h2::after {
      content: "";
      display: block;
      width: 100px;
      height: 4px;
      background: linear-gradient(90deg, #FFD700, #FFA500);
      margin: 15px auto 0;
      border-radius: 2px;
    }

    /* Tables */
    table {
      width: 100%;
      border-collapse: collapse;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      position: relative;
      z-index: 1;
      background: rgba(255, 255, 255, 0.05);
    }

    th {
      background: linear-gradient(135deg, #FFD700, #FFA500);
      color: #003366;
      padding: 20px 15px;
      text-align: center;
      font-weight: 800;
      font-size: 16px;
      text-transform: uppercase;
      letter-spacing: 1px;
      position: relative;
    }

    th::after {
      content: "";
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, transparent, rgba(0, 51, 102, 0.3), transparent);
    }

    td {
      padding: 18px 15px;
      text-align: center;
      font-size: 16px;
      font-weight: 500;
      border-bottom: 1px solid rgba(255, 215, 0, 0.1);
      transition: all 0.3s ease;
      position: relative;
    }

    tr:nth-child(even) {
      background: rgba(255, 255, 255, 0.03);
    }

    tr:hover {
      background: rgba(255, 215, 0, 0.1);
      transform: scale(1.02);
      box-shadow: 0 5px 15px rgba(255, 215, 0, 0.2);
    }

    /* Position styling */
    tbody tr:nth-child(1) {
      background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 215, 0, 0.1));
      font-weight: 700;
    }

    tbody tr:nth-child(1) td:first-child {
      color: #FFD700;
      font-size: 20px;
      font-weight: 900;
      text-shadow: 0 0 15px #FFD700;
    }

    
    tbody tr:nth-child(2) {
      background: linear-gradient(135deg, rgba(192, 192, 192, 0.2), rgba(192, 192, 192, 0.1));
      font-weight: 700;
    }

    tbody tr:nth-child(2) td:first-child {
      color: #C0C0C0;
      font-size: 20px;
      font-weight: 900;
      text-shadow: 0 0 15px #C0C0C0;
    }

    

    tbody tr:nth-child(3) {
      background: linear-gradient(135deg, rgba(205, 127, 50, 0.2), rgba(205, 127, 50, 0.1));
      font-weight: 700;
    }

    tbody tr:nth-child(3) td:first-child {
      color: #CD7F32;
      font-size: 20px;
      font-weight: 900;
      text-shadow: 0 0 15px #CD7F32;
    }

  

    /* Score columns styling */
    td:nth-child(4),
    td:nth-child(5),
    td:nth-child(6),
    td:nth-child(7) {
      font-weight: 700;
      color: #FFD700;
      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
      font-size: 17px;
    }

    td:last-child {
      font-size: 20px;
      font-weight: 900;
      color: #FFD700;
      text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.5);
      background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 165, 0, 0.1));
    }

    /* Loading animation */
    .loading {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 200px;
      font-size: 20px;
      color: #FFD700;
    }

    .loading::before {
      content: "‚≠ê";
      font-size: 30px;
      animation: spin 1s linear infinite;
      margin-right: 15px;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    /* Responsive design */
    @media (max-width: 1200px) {
      .container {
        padding: 30px 15px;
      }

      .header h1 {
        font-size: 40px;
      }

      .category-block h2 {
        font-size: 28px;
      }

      th,
      td {
        padding: 15px 10px;
        font-size: 14px;
      }
    }

    @media (max-width: 768px) {
      .header h1 {
        font-size: 32px;
        letter-spacing: 1px;
      }

      .header-subtitle {
        font-size: 16px;
      }

      .controls {
        padding: 20px;
        margin-bottom: 25px;
      }

      .controls label {
        display: block;
        margin-bottom: 10px;
      }

      .category-block {
        padding: 20px;
        margin-bottom: 30px;
      }

      .category-block h2 {
        font-size: 24px;
      }

      /* Make table scrollable on mobile */
      .table-container {
        overflow-x: auto;
        border-radius: 15px;
      }

      table {
        min-width: 600px;
      }

      th,
      td {
        padding: 12px 8px;
        font-size: 13px;
        white-space: nowrap;
      }
    }

    @media (max-width: 480px) {
      .container {
        padding: 20px 10px;
      }

      .header {
        padding: 20px 0;
      }

      .header h1 {
        font-size: 28px;
      }

      .controls {
        padding: 15px;
      }

      .category-block {
        padding: 15px;
      }
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, #FFD700, #FFA500);
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(135deg, #FFA500, #FFD700);
    }

    /* Fade in animation */
    .fade-in {}

    @keyframes fadeIn {
      0% {
        opacity: 0;
        transform: translateY(20px);
      }

      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Floating particles */
    .particle-bg {
      position: fixed;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
    }

    .floating-particle {
      position: absolute;
      background: rgba(255, 215, 0, 0.3);
      border-radius: 50%;
      animation: float-up 8s linear infinite;
    }

    .floating-particle:nth-child(1) {
      width: 6px;
      height: 6px;
      left: 10%;
      animation-delay: 0s;
    }

    .floating-particle:nth-child(2) {
      width: 4px;
      height: 4px;
      left: 30%;
      animation-delay: 2s;
    }

    .floating-particle:nth-child(3) {
      width: 8px;
      height: 8px;
      left: 50%;
      animation-delay: 4s;
    }

    .floating-particle:nth-child(4) {
      width: 5px;
      height: 5px;
      left: 70%;
      animation-delay: 6s;
    }

    .floating-particle:nth-child(5) {
      width: 7px;
      height: 7px;
      left: 90%;
      animation-delay: 1s;
    }

    @keyframes float-up {
      0% {
        transform: translateY(100vh) rotate(0deg);
        opacity: 0;
      }

      10% {
        opacity: 1;
      }

      90% {
        opacity: 1;
      }

      100% {
        transform: translateY(-10vh) rotate(360deg);
        opacity: 0;
      }
    }
  </style>
</head>

<body>
  <div class="particle-bg">
    <div class="floating-particle"></div>
    <div class="floating-particle"></div>
    <div class="floating-particle"></div>
    <div class="floating-particle"></div>
    <div class="floating-particle"></div>
  </div>

  <div class="header">
    <div class="header-content">
      <h1>üèÜ Rankings</h1>
      <div class="header-subtitle">Concursul Na»õional de GimnasticƒÉ AerobicƒÉ - Cupa Ia»ôului</div>
    </div>
  </div>

  <div class="container">
    <div class="controls fade-in">
      <label for="category-select">Filter By Category</label>
      <select id="category-select">
        <option value="all">All categories</option>
      </select>
    </div>

    <div id="rankings-container" class="fade-in">
      <div class="loading">Loading...<div>
        </div>
      </div>

      <script>
        async function loadRankings() {
          try {
            const res = await fetch("/api/rankings");
            const rankings = await res.json();

            const select = document.getElementById("category-select");
            const container = document.getElementById("rankings-container");
            const selected = select.value;

            // Populate dropdown once
            if (select.options.length === 1) {
              Object.keys(rankings).forEach(cat => {
                const opt = document.createElement("option");
                opt.value = cat;
                opt.textContent = cat;
                select.appendChild(opt);
              });
            }

            container.innerHTML = "";

            Object.entries(rankings).forEach(([category, list]) => {
              if (selected !== "all" && selected !== category) return;

              let html = `
              <div class="category-block fade-in" data-category="${category}">
                <h2>${category}</h2>
                <div class="table-container">
                  <table>
                    <thead>
                      <tr>
                        <th>Position</th>
                        <th>Competitor</th>
                        <th>Club</th>
                        <th>Execution</th>
                        <th>Artistry</th>
                        <th>Difficulty</th>
                        <th>Total</th>
                      </tr>
                    </thead>
                    <tbody>`;

              list.forEach(item => {
                let medal = "";
                if (item.position === 1) medal = "ü•á";
                else if (item.position === 2) medal = "ü•à";
                else if (item.position === 3) medal = "ü•â";

                html += `
    <tr>
      <td>${item.position} ${medal}</td>
      <td>${item.competitor}</td>
      <td>${item.club}</td>
      <td>${item.execution_score.toFixed(3)}</td>
      <td>${item.artistry_score.toFixed(3)}</td>
      <td>${item.difficulty_score.toFixed(3)}</td>
      <td>${item.total_score.toFixed(3)}</td>
    </tr>`;
              });


              html += `
                    </tbody>
                  </table>
                </div>
              </div>`;
              container.innerHTML += html;
            });

            // Show message if no data
            if (container.innerHTML === "") {
              container.innerHTML = `
              <div class="category-block fade-in">
                <h2>Nu existƒÉ date disponibile</h2>
                <p style="text-align: center; font-size: 18px; color: #FFD700; margin-top: 20px;">
                  Clasamentele se vor afi»ôa pe mƒÉsurƒÉ ce concuren»õa progreseazƒÉ.
                </p>
              </div>`;
            }
          } catch (err) {
            console.error("Failed to fetch rankings:", err);
            document.getElementById("rankings-container").innerHTML = `
            <div class="category-block fade-in">
              <h2>‚ö†Ô∏è Eroare la √ÆncƒÉrcarea datelor</h2>
              <p style="text-align: center; font-size: 18px; color: #FFD700; margin-top: 20px;">
                Se re√ÆncearcƒÉ automat √Æn c√¢teva secunde...
              </p>
            </div>`;
          }
        }

        // Initial load
        loadRankings();

        // Refresh every 5s
        setInterval(loadRankings, 5000);

        // Reload data on category change
        document.getElementById("category-select").addEventListener("change", loadRankings);

        // Add some interactive particles on click
        document.addEventListener("click", function (e) {
          const particle = document.createElement("div");
          particle.style.position = "fixed";
          particle.style.left = e.clientX + "px";
          particle.style.top = e.clientY + "px";
          particle.style.width = "6px";
          particle.style.height = "6px";
          particle.style.background = "#FFD700";
          particle.style.borderRadius = "50%";
          particle.style.pointerEvents = "none";
          particle.style.zIndex = "1000";
          particle.style.animation = "clickBurst 0.6s ease-out forwards";

          document.body.appendChild(particle);

          setTimeout(() => {
            if (document.body.contains(particle)) {
              document.body.removeChild(particle);
            }
          }, 600);
        });

        // Add click burst animation
        const style = document.createElement("style");
        style.textContent = `
        @keyframes clickBurst {
          0% { transform: scale(1); opacity: 1; }
          100% { transform: scale(4); opacity: 0; }
        }
      `;
        document.head.appendChild(style);
      </script>
</body>

</html>